<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Takwirira Dental | Chipinge Oral Hygiene Centre</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'] },
                    colors: {
                        brand: {
                            50: '#f0f9ff', 100: '#e0f2fe', 400: '#38bdf8', 500: '#0ea5e9',
                            600: '#0284c7', 700: '#0369a1', 800: '#075985', 900: '#0c4a6e',
                        },
                        gold: { 400: '#fbbf24', 500: '#f59e0b', 600: '#d97706', 900: '#78350f' }
                    },
                    animation: { 'slide-up': 'slideUp 0.4s ease-out forwards' },
                    keyframes: { slideUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } } }
                }
            }
        }
    </script>

    <style>
        body { background-color: #f8fafc; overflow-x: hidden; }
        .view-section { display: none; min-height: calc(100vh - 80px); padding-top: 100px; padding-bottom: 80px; }
        @media (min-width: 1024px) { .view-section { padding-top: 100px; padding-bottom: 40px; } }
        .view-section.active { display: block; }
        .nav-item.active { color: #0284c7; background-color: #f0f9ff; font-weight: 700; }
        .booking-tab.active { background-color: #0c4a6e; color: white; border-color: #0c4a6e; }
        .booking-tab { transition: all 0.3s ease; }
        .glass-panel { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
        
        /* Chat Window */
        .chat-window {
            position: fixed; top: 85px; right: 16px; z-index: 1000; width: 350px; height: 500px;
            background: white; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            display: flex; flex-direction: column; overflow: hidden; transform-origin: top right;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1); opacity: 0; transform: scale(0.9) translateY(-10px);
            pointer-events: none; border: 1px solid #e2e8f0;
        }
        .chat-window.open { opacity: 1; transform: scale(1) translateY(0); pointer-events: all; }
        .chat-messages { flex: 1; padding: 16px; overflow-y: auto; background-color: #f8fafc; display: flex; flex-direction: column; gap: 12px; }
        .message { max-width: 85%; padding: 12px 16px; border-radius: 12px; font-size: 14px; line-height: 1.5; animation: fadeIn 0.3s ease; }
        .message.bot { background: #e0f2fe; color: #0c4a6e; align-self: flex-start; border-bottom-left-radius: 2px; }
        .message.user { background: #0c4a6e; color: white; align-self: flex-end; border-bottom-right-radius: 2px; }
        
        /* Loading Dots */
        .typing-dots { display: none; padding: 0 16px 8px; }
        .dot { height: 6px; width: 6px; background-color: #cbd5e1; border-radius: 50%; display: inline-block; animation: dot-pulse 1.5s infinite ease-in-out both; }
        .dot:nth-child(1) { animation-delay: -0.32s; }
        .dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes dot-pulse { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        @media (max-width: 640px) { .chat-window { width: calc(100vw - 32px); height: 60vh; right: 16px; } }
    </style>
</head>
<body class="text-slate-800 antialiased selection:bg-brand-100 selection:text-brand-900">

    <div class="fixed inset-0 z-0 pointer-events-none opacity-40">
        <div class="absolute top-0 right-0 w-[500px] h-[500px] bg-brand-100 rounded-full blur-[100px] -translate-y-1/2 translate-x-1/2"></div>
        <div class="absolute bottom-0 left-0 w-[500px] h-[500px] bg-blue-50 rounded-full blur-[100px] translate-y-1/2 -translate-x-1/2"></div>
    </div>

    <nav class="fixed top-0 w-full z-50 glass-panel shadow-sm transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <div class="flex items-center gap-2 cursor-pointer" onclick="switchTab('home')">
                    <div class="w-10 h-10 bg-brand-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-brand-200 flex-shrink-0">
                        <i class="fa-solid fa-tooth text-xl"></i>
                    </div>
                    <span class="font-bold text-lg md:text-xl tracking-tight text-brand-900">Takwirira<span class="text-brand-600 font-light">Dental</span></span>
                </div>
                <div class="hidden md:flex bg-slate-100/50 p-1 rounded-full border border-slate-200 backdrop-blur-md">
                    <button onclick="switchTab('home')" class="nav-item active px-5 py-2 rounded-full text-sm font-semibold transition-all duration-300 text-slate-600 hover:text-brand-700">Home</button>
                    <button onclick="switchTab('services')" class="nav-item px-5 py-2 rounded-full text-sm font-semibold transition-all duration-300 text-slate-600 hover:text-brand-700">Services & Booking</button>
                    <button onclick="switchTab('rewards')" class="nav-item px-5 py-2 rounded-full text-sm font-semibold transition-all duration-300 text-slate-600 hover:text-brand-700">Rewards</button>
                    <button onclick="switchTab('jobs')" class="nav-item px-5 py-2 rounded-full text-sm font-semibold transition-all duration-300 text-slate-600 hover:text-brand-700">Jobs</button>
                    <button onclick="switchTab('reviews')" class="nav-item px-5 py-2 rounded-full text-sm font-semibold transition-all duration-300 text-slate-600 hover:text-brand-700">Reviews</button>
                    <button onclick="switchTab('about')" class="nav-item px-5 py-2 rounded-full text-sm font-semibold transition-all duration-300 text-slate-600 hover:text-brand-700">About</button>
                </div>
                <div class="flex items-center gap-3">
                    <button onclick="toggleChat()" class="bg-brand-900 hover:bg-brand-800 text-white px-4 py-2.5 rounded-full font-bold text-sm shadow-md transition-all flex items-center gap-2 border-2 border-brand-800/50 active:scale-95">
                        <i class="fa-solid fa-robot"></i> <span class="hidden sm:inline">Ask AI</span>
                    </button>
                    <button class="md:hidden text-brand-900 text-2xl p-2" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')">
                        <i class="fa-solid fa-bars"></i>
                    </button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white border-b border-gray-100 absolute w-full left-0 top-20 shadow-lg z-50 p-4 space-y-2">
            <button onclick="switchTab('home')" class="block w-full text-left px-4 py-3 rounded-lg hover:bg-slate-50 font-semibold text-slate-700">Home</button>
            <button onclick="switchTab('services')" class="block w-full text-left px-4 py-3 rounded-lg hover:bg-slate-50 font-semibold text-slate-700">Services</button>
            <button onclick="switchTab('reviews')" class="block w-full text-left px-4 py-3 rounded-lg hover:bg-slate-50 font-semibold text-slate-700">Reviews</button>
        </div>
    </nav>

    <div class="chat-window" id="chat-window">
        <div class="bg-brand-900 p-4 text-white flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center"><i class="fa-solid fa-robot"></i></div>
                <div>
                    <p class="font-bold text-sm">Takwirira AI</p>
                    <p class="text-[10px] text-brand-100 flex items-center gap-1"><span class="w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"></span> Intelligent Assistant</p>
                </div>
            </div>
            <button onclick="toggleChat()" class="hover:bg-white/10 p-1 rounded"><i class="fa-solid fa-times"></i></button>
        </div>
        <div class="chat-messages" id="chat-messages">
            <div class="message bot">
                Hello! ðŸ‘‹ I am the Takwirira Intelligent Assistant.<br><br>
                I can help you with:<br>
                â€¢ Detailed Prices ðŸ’°<br>
                â€¢ Booking Appointments ðŸ“…<br>
                â€¢ Medical Advice (General) ðŸ©º<br>
                â€¢ Job Applications ðŸ’¼
            </div>
        </div>
        <div class="typing-dots" id="typing-indicator">
            <div class="dot"></div><div class="dot"></div><div class="dot"></div>
        </div>
        <div class="p-3 bg-white border-t border-slate-100 flex gap-2">
            <input type="text" id="chat-input" placeholder="Ask me anything..." class="flex-1 px-4 py-2 bg-slate-100 rounded-full text-sm outline-none focus:ring-2 focus:ring-brand-500 text-slate-800" onkeypress="handleChatKey(event)">
            <button onclick="sendMessage()" class="p-2 w-10 h-10 bg-brand-600 text-white rounded-full hover:bg-brand-700 flex items-center justify-center transition shadow-md"><i class="fa-solid fa-paper-plane"></i></button>
        </div>
    </div>

    <main class="relative z-10 max-w-7xl mx-auto px-4 lg:px-8">
        
        <div id="view-home" class="view-section active">
            <div class="flex flex-col lg:flex-row items-center gap-12 min-h-[calc(100vh-140px)] justify-center py-4">
                <div class="lg:w-1/2 space-y-6 animate-slide-up">
                    <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-brand-50 border border-brand-200 text-brand-700 text-xs font-bold uppercase tracking-wider">
                        <span class="w-2 h-2 rounded-full bg-brand-600 animate-pulse"></span> Opening Soon in Chipinge
                    </div>
                    <h1 class="text-5xl lg:text-7xl font-bold text-brand-900 leading-tight">The Future of <span class="text-brand-600">Oral Hygiene.</span></h1>
                    <p class="text-lg text-slate-700 font-medium">Takwirira Dental offers a premium, non-surgical approach to dental care. No drills, just pure clean comfort right here in the CBD.</p>
                    <div class="flex gap-4 pt-4">
                        <button onclick="switchTab('services')" class="px-8 py-4 bg-brand-700 hover:bg-brand-800 text-white rounded-xl font-bold shadow-xl">Book Appointment</button>
                    </div>
                </div>
                <div class="lg:w-1/2 animate-slide-up"><img src="./HomeImage.png" onerror="this.src='https://placehold.co/600x500/e2e8f0/94a3b8?text=Takwirira+Dental'" class="rounded-[2rem] shadow-2xl border-8 border-white w-full"></div>
            </div>
        </div>

        <div id="view-services" class="view-section">
            <div class="text-center mb-10"><h2 class="text-3xl font-bold text-brand-900">Services & Booking</h2></div>
            <div class="grid lg:grid-cols-12 gap-8">
                <div class="lg:col-span-7 space-y-4">
                    <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm cursor-pointer hover:border-brand-500" onclick="prefillService('Scale & Polish')">
                        <div class="flex justify-between font-bold text-brand-900"><h3>Scale & Polish</h3><span>$50.00</span></div>
                        <p class="text-sm text-slate-600">Full plaque removal and polish.</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm cursor-pointer hover:border-brand-500" onclick="prefillService('Teeth Whitening')">
                        <div class="flex justify-between font-bold text-brand-900"><h3>Teeth Whitening</h3><span>$150.00</span></div>
                        <p class="text-sm text-slate-600">Professional in-chair whitening.</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm cursor-pointer hover:border-brand-500" onclick="prefillService('Fluoride')">
                        <div class="flex justify-between font-bold text-brand-900"><h3>Fluoride Treatment</h3><span>$25.00</span></div>
                        <p class="text-sm text-slate-600">High concentration varnish.</p>
                    </div>
                </div>
                
                <div class="lg:col-span-5">
                     <div id="booking-container" class="bg-white rounded-3xl shadow-xl p-6 border border-slate-100 sticky top-28">
                        <h3 class="font-bold text-xl mb-4">Book Your Slot</h3>
                        <form class="space-y-4">
                            <input type="text" id="single-name" placeholder="Name" class="w-full px-4 py-3 bg-slate-50 border rounded-xl">
                            <input type="tel" id="single-phone" placeholder="Phone" class="w-full px-4 py-3 bg-slate-50 border rounded-xl">
                            <input type="date" id="single-date" class="w-full px-4 py-3 bg-slate-50 border rounded-xl">
                            <select id="single-service" class="w-full px-4 py-3 bg-slate-50 border rounded-xl">
                                <option>Scale & Polish</option><option>Whitening</option><option>Fluoride</option>
                            </select>
                            <button type="button" onclick="submitSingleBooking()" class="w-full py-4 bg-brand-900 text-white font-bold rounded-xl hover:bg-slate-900">Request via WhatsApp</button>
                        </form>
                     </div>
                </div>
            </div>
        </div>

        <div id="view-rewards" class="view-section">
            <div class="text-center"><h2 class="text-3xl font-bold text-brand-900">Rewards Program</h2><p>Coming Soon.</p></div>
        </div>
        
        <div id="view-jobs" class="view-section">
             <div class="text-center mb-10"><h2 class="text-3xl font-bold text-brand-900">We Are Hiring</h2></div>
             <div class="grid md:grid-cols-2 gap-6">
                 <div class="bg-white p-6 rounded-2xl border shadow-sm">
                     <h3 class="font-bold text-xl text-brand-900">Dental Hygienist</h3>
                     <p class="text-sm text-slate-600 mb-4">Registered professional needed.</p>
                     <button onclick="switchTab('job-apply')" class="w-full py-2 bg-brand-100 text-brand-700 font-bold rounded-lg">Apply Now</button>
                 </div>
                 <div class="bg-white p-6 rounded-2xl border shadow-sm">
                     <h3 class="font-bold text-xl text-brand-900">Internship</h3>
                     <p class="text-sm text-slate-600 mb-4">Student program with school fees support.</p>
                     <button onclick="switchTab('intern-apply')" class="w-full py-2 bg-brand-100 text-brand-700 font-bold rounded-lg">Apply Now</button>
                 </div>
             </div>
        </div>
        
        <div id="view-job-apply" class="view-section">
            <div class="max-w-2xl mx-auto bg-white p-8 rounded-3xl shadow-xl border border-slate-100">
                <button onclick="switchTab('jobs')" class="mb-4 text-sm font-bold text-slate-500">< Back</button>
                <h2 class="text-2xl font-bold mb-6">Quick Application</h2>
                <input type="text" id="app-name" placeholder="Full Name" class="w-full mb-4 px-4 py-3 border rounded-xl">
                <textarea id="app-question" rows="4" placeholder="Why are you a good fit?" class="w-full mb-4 px-4 py-3 border rounded-xl"></textarea>
                <button onclick="submitJobApplication()" class="w-full py-3 bg-brand-900 text-white font-bold rounded-xl">Send Application</button>
            </div>
        </div>
        
        <div id="view-intern-apply" class="view-section">
            <div class="max-w-2xl mx-auto bg-white p-8 rounded-3xl shadow-xl border border-slate-100">
                <button onclick="switchTab('jobs')" class="mb-4 text-sm font-bold text-slate-500">< Back</button>
                <h2 class="text-2xl font-bold mb-6">Internship Application</h2>
                <input type="text" id="intern-fname" placeholder="Full Name" class="w-full mb-4 px-4 py-3 border rounded-xl">
                <textarea id="intern-statement" rows="4" placeholder="Your story..." class="w-full mb-4 px-4 py-3 border rounded-xl"></textarea>
                <button onclick="submitInternApplication()" class="w-full py-3 bg-brand-900 text-white font-bold rounded-xl">Send Application</button>
            </div>
        </div>
        
        <div id="view-about" class="view-section">
            <div class="text-center max-w-2xl mx-auto">
                <h2 class="text-3xl font-bold text-brand-900 mb-4">Licensed & Safe</h2>
                <p>Takwirira Dental is a fully licensed oral hygiene centre. We prioritize sterility, education, and gentle care.</p>
            </div>
        </div>

        <div id="view-reviews" class="view-section">
            <div class="text-center mb-12 animate-slide-up">
                <h2 class="text-3xl font-bold text-brand-900">Patient Stories</h2>
                <p class="text-slate-600 font-medium">Authentic feedback from our community.</p>
            </div>

            <div class="max-w-4xl mx-auto">
                <div id="reviews-container" class="mb-10 animate-slide-up">
                    </div>

                <div class="bg-white p-8 rounded-2xl shadow-lg border border-slate-200 animate-slide-up" style="animation-delay: 0.2s;">
                    <h3 class="font-bold text-lg mb-4 text-brand-900">Share your experience</h3>
                    <form id="review-form" class="space-y-4">
                        <div class="grid md:grid-cols-2 gap-4">
                            <input type="text" id="review-name" placeholder="Your Name" class="px-4 py-3 bg-slate-50 border border-slate-300 rounded-xl focus:outline-none focus:border-brand-500 text-slate-900 placeholder-slate-400" required>
                            <select id="review-rating" class="px-4 py-3 bg-slate-50 border border-slate-300 rounded-xl text-slate-900 font-bold">
                                <option value="5" selected>â˜…â˜…â˜…â˜…â˜… (5/5)</option>
                                <option value="4">â˜…â˜…â˜…â˜…â˜† (4/5)</option>
                                <option value="3">â˜…â˜…â˜…â˜†â˜† (3/5)</option>
                                <option value="2">â˜…â˜…â˜†â˜†â˜† (2/5)</option>
                                <option value="1">â˜…â˜†â˜†â˜†â˜† (1/5)</option>
                            </select>
                        </div>
                        <textarea id="review-text" placeholder="Tell us about your visit..." rows="3" class="w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-xl focus:outline-none focus:border-brand-500 text-slate-900 placeholder-slate-400" required></textarea>
                        <button type="submit" class="w-full bg-brand-900 text-white px-6 py-3 rounded-xl font-bold hover:bg-slate-900 transition shadow-lg">Post Review</button>
                    </form>
                </div>
            </div>
        </div>

    </main>

    <script>
        // --- 1. NAVIGATION & GENERAL ---
        function switchTab(tabId) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            const target = document.getElementById('view-' + tabId);
            if(target) target.classList.add('active');
            document.querySelectorAll(`button[onclick="switchTab('${tabId}')"]`).forEach(b => {
                if(b.classList.contains('nav-item')) b.classList.add('active');
            });
            window.scrollTo({ top: 0, behavior: 'smooth' });
            document.getElementById('mobile-menu').classList.add('hidden');
        }

        function prefillService(name) {
            switchTab('services');
            document.getElementById('single-service').value = name;
            document.getElementById('booking-container').scrollIntoView({ behavior: 'smooth' });
        }

        // --- 2. REVIEW SYSTEM (LOCALSTORAGE) ---
        // Empty array by default - no fake reviews.
        function getReviews() {
            const saved = localStorage.getItem('takwirira_reviews_v1');
            return saved ? JSON.parse(saved) : []; 
        }

        function renderReviews() {
            const reviews = getReviews();
            const container = document.getElementById('reviews-container');
            
            if (reviews.length === 0) {
                container.innerHTML = `
                    <div class="text-center p-10 bg-slate-100 rounded-3xl border border-dashed border-slate-300">
                        <i class="fa-regular fa-comment-dots text-4xl text-slate-400 mb-3"></i>
                        <h3 class="text-xl font-bold text-slate-600">No reviews yet</h3>
                        <p class="text-slate-500">Be the first to share your smile with Chipinge!</p>
                    </div>
                `;
                return;
            }

            // Calculate Stats
            const total = reviews.reduce((acc, r) => acc + r.stars, 0);
            const avg = (total / reviews.length).toFixed(1);
            
            // Build Stars HTML
            const starsHTML = (score) => {
                return '<i class="fa-solid fa-star text-yellow-400"></i>'.repeat(score) + 
                       '<i class="fa-regular fa-star text-slate-200"></i>'.repeat(5 - score);
            };

            const header = `
                <div class="flex flex-col items-center mb-10">
                    <span class="text-6xl font-bold text-brand-900 tracking-tighter">${avg}</span>
                    <div class="flex gap-1 text-2xl my-2">${starsHTML(Math.round(avg))}</div>
                    <span class="text-slate-500 font-medium">${reviews.length} Patient Reviews</span>
                </div>
            `;

            const list = reviews.map(r => `
                <div class="bg-white p-6 rounded-2xl border border-slate-100 shadow-sm mb-4 transition hover:shadow-md">
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <h4 class="font-bold text-slate-900">${r.name}</h4>
                            <span class="text-xs text-slate-400 font-mono">${r.date}</span>
                        </div>
                        <div class="text-sm">${starsHTML(r.stars)}</div>
                    </div>
                    <p class="text-slate-700 leading-relaxed">"${r.text}"</p>
                </div>
            `).join('');

            container.innerHTML = header + '<div class="grid gap-4">' + list + '</div>';
        }

        document.getElementById('review-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('review-name').value;
            const text = document.getElementById('review-text').value;
            const stars = parseInt(document.getElementById('review-rating').value);

            const newReview = {
                name: name,
                text: text,
                stars: stars,
                date: new Date().toLocaleDateString()
            };

            const reviews = getReviews();
            reviews.unshift(newReview); // Add to top
            localStorage.setItem('takwirira_reviews_v1', JSON.stringify(reviews));
            
            renderReviews();
            e.target.reset();
            alert("Thank you! Your review has been saved locally.");
        });

        // Initialize Reviews
        renderReviews();

        // --- 3. ADVANCED "LOCAL BRAIN" AI ---
        // This is the "LLM-Like" Keyword Scorer
        
        const knowledgeBase = [
            // PRIORITY 1: Specific Service Prices
            { keys: ["scale", "polish", "cleaning price", "wash teeth"], score: 2, text: "A Scale & Polish is **$50**. This removes plaque and tartar. It's our most popular service!" },
            { keys: ["whitening", "white", "yellow", "bright"], score: 2, text: "Professional Teeth Whitening is **$150**. It is done in-chair for instant results. We also offer Stain Removal for **$60** if you just have coffee/tobacco stains." },
            { keys: ["fluoride"], score: 2, text: "Fluoride treatment is **$25**. It's great for strengthening enamel, especially for children." },
            { keys: ["deep", "root", "gum disease"], score: 2, text: "Deep Cleaning (SRP) is **$120**. This is a medical treatment for gum disease." },
            { keys: ["guard", "grinding", "sport"], score: 2, text: "We make custom Mouth Guards. Sports guards are **$90** and Night Guards for grinding are **$100**." },

            // PRIORITY 2: General Categories
            { keys: ["price", "cost", "how much", "money", "$", "rates"], score: 1, text: "Here is a quick price list:\nâ€¢ Cleaning: $50\nâ€¢ Whitening: $150\nâ€¢ Consultation: $20-$30\nâ€¢ Kids Fluoride: $25\n\nSee the 'Services' tab for more!" },
            { keys: ["book", "appoint", "schedule", "slot", "visit", "reserve"], score: 1, text: "You can book easily! Just go to the **'Services & Booking'** tab on this page, or tell me your name and phone number here and I'll generate a WhatsApp link." },
            { keys: ["location", "where", "address", "find", "map"], score: 1, text: "We are located in **Chipinge CBD**. Look for the Takwirira Dental signage near the main shops. It's easy to find!" },
            { keys: ["hour", "open", "time", "close", "day", "weekend"], score: 1, text: "We are open **Monday to Friday**, 8:00 AM to 6:00 PM. We are closed on weekends." },
            
            // PRIORITY 3: Medical/Jobs/Etc
            { keys: ["job", "work", "hiring", "vacancy", "cv"], score: 1, text: "Yes, we are hiring! Please check the **'Jobs'** tab to see open positions for Hygienists and Cleaners." },
            { keys: ["intern", "student", "learn", "attachment"], score: 1, text: "We have a Student Wellness Internship! It helps with school fees. Check the 'Jobs' tab to apply." },
            { keys: ["pain", "hurt", "blood", "emergency", "ache"], score: 3, text: "ðŸš¨ If you are in pain, please book a slot immediately or visit us. Do not wait. If it is an emergency, message us on WhatsApp directly." },
            
            // PRIORITY 4: Greetings
            { keys: ["hello", "hi", "hey", "morning", "afternoon"], score: 0.5, text: "Hello there! ðŸ‘‹ How can I help your smile today? You can ask me about prices, booking, or services." },
            { keys: ["thank", "thx", "goodbye", "bye"], score: 0.5, text: "You're welcome! Keep smiling. ðŸ˜" }
        ];

        function toggleChat() {
            document.getElementById('chat-window').classList.toggle('open');
            document.getElementById('chat-input').focus();
        }

        function handleChatKey(e) { if(e.key === 'Enter') sendMessage(); }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const text = input.value.trim().toLowerCase();
            if(!text) return;

            addMessage(input.value, 'user');
            input.value = '';

            // Show typing
            const dots = document.getElementById('typing-indicator');
            const msgs = document.getElementById('chat-messages');
            dots.style.display = 'block';
            msgs.scrollTop = msgs.scrollHeight;

            // "LLM" Logic: Find the best match based on Score
            setTimeout(() => {
                let bestMatch = null;
                let highestScore = 0;

                knowledgeBase.forEach(item => {
                    // Count how many keywords match
                    const matchCount = item.keys.filter(k => text.includes(k)).length;
                    if (matchCount > 0) {
                        const currentScore = matchCount * item.score; // Multiply by weight
                        if (currentScore > highestScore) {
                            highestScore = currentScore;
                            bestMatch = item;
                        }
                    }
                });

                let reply = "";
                if (bestMatch) {
                    reply = bestMatch.text;
                } else {
                    // Fallback "Hallucination" handler
                    reply = "I'm mostly trained on prices and booking, so I didn't quite catch that. ðŸ¤”\n\nWould you like to **Book an Appointment** or chat with a human on **WhatsApp**?";
                }

                dots.style.display = 'none';
                addMessage(reply, 'bot');
            }, 700); // Slight delay for realism
        }

        function addMessage(html, type) {
            const div = document.createElement('div');
            div.className = `message ${type}`;
            div.innerHTML = html.replace(/\n/g, '<br>'); // Handle line breaks
            document.getElementById('chat-messages').appendChild(div);
            document.getElementById('chat-messages').scrollTop = 9999;
        }

        // --- 4. FORM HANDLERS ---
        function submitSingleBooking() {
            const n = document.getElementById('single-name').value;
            const s = document.getElementById('single-service').value;
            if(!n) return alert("Please enter your name.");
            window.open(`https://wa.me/263788643858?text=Booking Request: ${n} for ${s}`, '_blank');
        }

        function submitJobApplication() {
            const n = document.getElementById('app-name').value;
            const q = document.getElementById('app-question').value;
            if(!n) return alert("Please enter your name.");
            window.location.href = `mailto:info@takwiriradental.co.zw?subject=Job App: ${n}&body=${q}`;
        }
        
        function submitInternApplication() {
            const n = document.getElementById('intern-fname').value;
            const q = document.getElementById('intern-statement').value;
            if(!n) return alert("Please enter your name.");
            window.location.href = `mailto:info@takwiriradental.co.zw?subject=Intern App: ${n}&body=${q}`;
        }

    </script>
</body>
</html>
